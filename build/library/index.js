/*! v1.0.1 Build Tue, 26 Jul 2016 16:20:23 GMT */
!function(){var e={},t=function(){var t,n,r,o=Array.prototype.slice.call(arguments,0);"string"==typeof o[0]?(r=o[0],t=o[1],n=o[2]):Array.isArray(o[0])&&(t=o[0],n=o[1]);var i=t.reduce(function(e,t){return e.addDependency(t)},tau.mashups);return i=i.addDependency(r+"/config"),i=i.addMashup(function(){var o=Array.prototype.slice.call(arguments,0);if(t.length>0&&1===o.length)throw new Error("Can't properly load dependencies for mashup \""+r+'", mashup is stopped.');return e.variables=o[o.length-1],o.length-t.length===2?e.config=o[o.length-2]:e.config={},Object.freeze&&(Object.freeze(e.variables),Object.freeze(e.config),Object.freeze(e)),n.apply(null,o)})};t("EmbeddedPages",["Underscore","jQuery","tau/configurator","tau/models/page.entity/entity.context.factory","tau/models/board.customize.units/const.entity.types.names","tau/models/board.customize.units/const.card.sizes","tau/models/board.customize.units/board.customize.units.interaction"],function(t,n,r,o,i,a,u){return function(t){function n(e){if(r[e])return r[e].exports;var o=r[e]={exports:{},id:e,loaded:!1};return t[e].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var r={};return n.m=t,n.c=r,n.p="",n.p=e.variables?e.variables.mashupPath:n.p,n(0)}([function(e,t,n){n(1),n(18),e.exports=n(19)},function(t,n,r){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},a=r(2),u=r(3),s=o(u),c=r(4),f=o(c),l=r(5),d=o(l),p=r(6),m=r(14),v=o(m),h=f["default"].getGlobalBus(),y=function(e){var t=e.url;return'<iframe class="'+v["default"].frame+'" src="'+t+'" frameborder="0"></iframe>'},g=function(e){var t=e.name;return'<span class="'+v["default"].empty+"\">Nothing to display in the Tab: the value of the '"+t+"' Custom Field is empty.</span>"},b=function k(e){if("tabs"===e.type)return e;if(e.children)for(var t=0;t<e.children.length;t++){var n=k(e.children[t]);if(n)return n}return null},x=function(e,t,n){var r=new u.Deferred,o=new u.Deferred;return e(o.resolve,n),o.then(function(e){if(e){var r=e.label,o=e.render,i=e.onDestroy,u=void 0===i?a.noop:i,s=b(t)||{tabs:[]},c="tab"+s.tabs.length,f="header_"+c,l="content_"+c;s.tabs.push({label:c,header:[{type:"label",name:f,text:r}],items:[{name:l,type:"container"}]});var d=(0,p.addBusListener)(l,"afterRender",function(e){"string"==typeof o?e.data.element.html(o):o(e.data.element.first(),n)}),m=(0,p.addBusListener)(l,"destroy",function(e){d.remove(),m.remove(),u(e)})}}).then(r.resolve),r.promise()},C=function(e){return e.toLowerCase()},L=function(e,t){var n=C(e);return(0,a.find)(t,function(e){return C(e.name)===n})},w=function(e,t,n){return e.getDef(t.entityType.name,{id:t.id,fields:["customFields"]}).then(function(e){return L(n,e.customFields)})},j=function(e,t,n,r){var o={};return e.on({eventName:"afterSave",type:t.entityType.name,listener:o,filter:{id:t.id},hasChanges:["customFields"]},function(e){var t=L(n,e.data.changes.customFields);t&&r(t.value)}),o},N=function(e,t){switch(C(e.type)){case"url":return t&&t.url?t.url:null;case"templatedurl":return t?String(e.value).replace(/\{0\}/,t):null;default:return""}},B=function(e,t){return(0,a.isFunction)(e)?e(t):s["default"].tmpl(e,t)},O=function(e){var t=80,n=e.closest(".tau-page-entity").find(".additional-info");e.css({height:n.height()-t})},R=function(e,t,n,r,o){var i=N(n,r),a={url:i,name:n.name},u=(0,s["default"])(B(i?t:g,a));if((0,s["default"])(e).html(u),o){var c=3e3;O(u),setTimeout(function(){return O(u)},c)}},S=function(e,t,n,r,o){var i=!n.frameTemplate,a=n.frameTemplate||y;(0,u.when)(w(e,t,n.customFieldName)).then(function(e){var t=e.value;return R(o,a,r,t,i)});var s=j(e,t,n.customFieldName,function(e){return R(o,a,r,e,i)});return function(){return e.unbind(s)}},U=function(e){return d["default"].create(e,f["default"])},A=function(e,t){return(0,u.when)(U(e)).then(function(e){return(0,a.find)(e.getCustomFields(),function(e){return C(e.name)===C(t.customFieldName)&&C(e.entityKind)===C(t.entityTypeName)})})},z=function(e){return(0,u.when)(U(e)).then(function(e){return e.getProcess()})},F=function(e){var t=C(e.type);return"url"===t||"templatedurl"===t},T=function(e,t,n){var r=n.entity;return C(r.entityType.name)!==C(e.entityTypeName)?t():(0,u.when)(A(r,e),e.processName?z(r):null).then(function(o,a){if(!o||!F(o))return t();if(a&&C(a.name)!==C(e.processName))return t();try{var u=function(){var i=void 0;return{v:t({label:e.customFieldName,render:function(t){var a=n.configurator.getStore();i=S(a,r,e,o,t)},onDestroy:function(){return i()}})}}();if("object"===("undefined"==typeof u?"undefined":i(u)))return u.v}catch(s){throw t(),s}})},D=function(e){h.once("contextRetrieved",function(){h.on("configReadyForIntegration",function(t){var n=t.data,r=e.map(function(e){var t=function(t,n){return T(e,t,n)};return x(t,{children:n.children},n.context)});r.unshift(n.integrationReadyPromise),n.integrationReadyPromise=u.when.apply(null,r).then(function(e){return e})})})},E=function(e){D(e.tabs)};E(e.config)},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e,t){e.exports=o},function(e,t,n){"use strict";var r=n(7),o=n(8),i=n(9),a=n(13);e.exports={addBusListener:o.addBusListener,addBusListenerOnce:o.addBusListenerOnce,getAppConfigurator:r.getAppConfigurator,configurator:r,events:o,customUnits:i,debug:a}},function(e,t,n){"use strict";var r=n(4),o=n(3),i=new o.Deferred;r.getGlobalBus().on("configurator.ready",function(e,t){t._id&&!t._id.match(/global/)&&i.resolve(t)});var a=function(){return i.promise()};e.exports={getAppConfigurator:a}},function(e,t,n){"use strict";var r=n(4),o=r.getBusRegistry(),i=function(e){return function(){e.apply(null,Array.prototype.slice.call(arguments).slice(1))}},a=function(e,t,n,r){var a=i(function(o){var i=o.bus;i.name===e&&i[r?"once":"on"](t,n)}),u=o.addEventListener("create",a);return o.addEventListener("destroy",i(function(r){var o=r.bus;o.name===e&&o.removeListener(t,n,u)})),{remove:function(){o.removeListener("create",a,u),o.getByName(e).then(function(e){e.removeListener(t,n,u)})}}},u=function(e,t,n){return a(e,t,n,!0)};e.exports={addBusListener:a,addBusListenerOnce:u}},function(e,t,n){"use strict";var r=n(10),o=n(11),i=n(12).openUnitEditor,a=n(7),u=function(e){return Object.keys(e||{}).reduce(function(t,n){return t[n]=e[n],t},{})},s=function(e){var t=u(e);return t.types=t.types||[r.ANY_TYPE],t.sizes=t.sizes||Object.keys(o).map(function(e){return o[e]}),a.getAppConfigurator().then(function(n){var r=n.getUnitsRegistry();if(!t.id)throw new Error('Field "id" is required for custom unit config');if(r.units[t.id])throw new Error('Custom unit with id "'+t.id+'" has been already registered');t.name=t.name||t.id,t.model=t.model||t.sampleData?t.model:{dummy:1},"string"!=typeof t.model&&"object"==typeof t.model&&(t.model=Object.keys(t.model).reduce(function(e,n){return e.concat(n+":"+t.model[n])},[]).join(", ")),t.sampleData=t.sampleData||{},t.template="object"==typeof e.template?u(t.template):t.template||{markup:['<div class="tau-board-unit__value">'+t.id+"</div>"]},"string"==typeof t.template&&(t.template={markup:[t.template]}),"string"==typeof t.template.markup&&(t.template.markup=[t.template.markup]),t.outerClassName&&(t.classId=t.outerClassName),t.priority&&(t.priority=Number(t.priority)),t.isEditable&&(t.interactionConfig={isEditable:t.isEditable},t.editorHandler?t.interactionConfig.handler=t.editorHandler:t.interactionConfig.handler=function(e,n){var r=e.cardDataForUnit,o=t.editorComponentName instanceof Function?t.editorComponentName(r):t.editorComponentName,a=i(o,{});if(t.editorData){var u={};Object.keys(t.editorData).forEach(function(e){var n=t.editorData[e];u[e]=n instanceof Function?n(r):r[n]}),e.cardDataForUnit=u}return a(e,n)}),r.units[t.id]=r.register([t])[t.id]})};e.exports={types:r,sizes:o,add:s}},function(e,t){e.exports=i},function(e,t){e.exports=a},function(e,t){e.exports=u},function(e,t,n){"use strict";var r=n(4),o=r.getBusRegistry(),i=function(){o.on("create",function(e,t){var n=t.bus;n.on("afterRender",function(e,t){t.element.attr("data-component-name",n.name)})})},a=function(e,t){var n=e;e?"string"==typeof e&&(n=function(t){return(t.name||t.id)===e}):n=function(){return!0},t||(t=function(e,t,n){console.log("LOG BUS",e,t,n)});var o=r.getGlobalBus(),i=o.fire.bind(o);o.fire=function(e,r,o){return o&&n(o,e,r)&&t(o.name||o.id,e,r),i(e,r,o)}};e.exports={showComponentsNames:i,logBus:a}},function(e,t,n){var r=n(15);"string"==typeof r&&(r=[[e.id,r,""]]);n(17)(r,{});r.locals&&(e.exports=r.locals)},function(e,t,n){t=e.exports=n(16)(),t.push([e.id,".XQLfJ1fOSeM_6mWJdOjSz{width:100%;height:700px;overflow:scroll;border:1px solid #ccc;min-height:70vh}._2hqpnQvyimzihTcycgAvjw{color:#bbb;font-size:11px;display:block}",""]),t.locals={frame:"XQLfJ1fOSeM_6mWJdOjSz",empty:"_2hqpnQvyimzihTcycgAvjw"}},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(r[i]=!0)}for(o=0;o<t.length;o++){var a=t[o];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},function(e,t,n){function r(e,t){for(var n=0;n<e.length;n++){var r=e[n],o=p[r.id];if(o){o.refs++;for(var i=0;i<o.parts.length;i++)o.parts[i](r.parts[i]);for(;i<r.parts.length;i++)o.parts.push(c(r.parts[i],t))}else{for(var a=[],i=0;i<r.parts.length;i++)a.push(c(r.parts[i],t));p[r.id]={id:r.id,refs:1,parts:a}}}}function o(e){for(var t=[],n={},r=0;r<e.length;r++){var o=e[r],i=o[0],a=o[1],u=o[2],s=o[3],c={css:a,media:u,sourceMap:s};n[i]?n[i].parts.push(c):t.push(n[i]={id:i,parts:[c]})}return t}function i(e,t){var n=h(),r=b[b.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),b.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(t)}}function a(e){e.parentNode.removeChild(e);var t=b.indexOf(e);t>=0&&b.splice(t,1)}function u(e){var t=document.createElement("style");return t.type="text/css",i(e,t),t}function s(e){var t=document.createElement("link");return t.rel="stylesheet",i(e,t),t}function c(e,t){var n,r,o;if(t.singleton){var i=g++;n=y||(y=u(t)),r=f.bind(null,n,i,!1),o=f.bind(null,n,i,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=s(t),r=d.bind(null,n),o=function(){a(n),n.href&&URL.revokeObjectURL(n.href)}):(n=u(t),r=l.bind(null,n),o=function(){a(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else o()}}function f(e,t,n,r){var o=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=x(t,o);else{var i=document.createTextNode(o),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(i,a[t]):e.appendChild(i)}}function l(e,t){var n=t.css,r=t.media;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function d(e,t){var n=t.css,r=t.sourceMap;r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var o=new Blob([n],{type:"text/css"}),i=e.href;e.href=URL.createObjectURL(o),i&&URL.revokeObjectURL(i)}var p={},m=function(e){var t;return function(){return"undefined"==typeof t&&(t=e.apply(this,arguments)),t}},v=m(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),h=m(function(){return document.head||document.getElementsByTagName("head")[0]}),y=null,g=0,b=[];e.exports=function(e,t){t=t||{},"undefined"==typeof t.singleton&&(t.singleton=v()),"undefined"==typeof t.insertAt&&(t.insertAt="bottom");var n=o(e);return r(n,t),function(e){for(var i=[],a=0;a<n.length;a++){var u=n[a],s=p[u.id];s.refs--,i.push(s)}if(e){var c=o(e);r(c,t)}for(var a=0;a<i.length;a++){var s=i[a];if(0===s.refs){for(var f=0;f<s.parts.length;f++)s.parts[f]();delete p[s.id]}}}};var x=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()},function(e,t,n){e.exports=n.p+"./mashup.config.js"},function(e,t){}])})}();