/*! v1.0.0 Build Mon, 15 Feb 2016 09:06:51 GMT */
!function(){var e={},t=function(){var t,n,r,o=Array.prototype.slice.call(arguments,0);"string"==typeof o[0]?(r=o[0],t=o[1],n=o[2]):Array.isArray(o[0])&&(t=o[0],n=o[1]);var i=t.reduce(function(e,t){return e.addDependency(t)},tau.mashups);return i=i.addDependency(r+"/config"),i=i.addMashup(function(){var o=Array.prototype.slice.call(arguments,0);if(t.length>0&&1===o.length)throw new Error("Can't properly load dependencies for mashup \""+r+'", mashup is stopped.');return e.variables=o[o.length-1],o.length-t.length===2?e.config=o[o.length-2]:e.config={},Object.freeze&&(Object.freeze(e.variables),Object.freeze(e.config),Object.freeze(e)),n.apply(null,o)})};t("EmbeddedPages",["Underscore","jQuery","tau/configurator","tau/models/page.entity/entity.context.factory","tau/models/board.customize.units/const.entity.types.names","tau/models/board.customize.units/const.card.sizes","tau/models/board.customize.units/board.customize.units.interaction"],function(t,n,r,o,i,a,u){return function(t){function n(e){if(r[e])return r[e].exports;var o=r[e]={exports:{},id:e,loaded:!1};return t[e].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var r={};return n.m=t,n.c=r,n.p="",n.p=e.variables?e.variables.mashupPath:n.p,n(0)}([function(e,t,n){n(1),n(18),e.exports=n(19)},function(t,n,r){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=r(2),s=r(3),c=o(s),f=r(4),l=o(f),d=r(5),p=o(d),m=r(6),h=r(14),v=o(h),y=l["default"].getGlobalBus(),g=function(e){var t=e.url;return'<iframe class="'+v["default"].frame+'" src="'+t+'" frameborder="0"></iframe>'},b=function(e){var t=e.name;return'\n    <span class="'+v["default"].empty+"\">\n        Nothing to display in the Tab: the value of the '"+t+"' Custom Field is empty,\n    </span>\n"},x=function(e){var t=(0,u.jsonSelect)(e.children,':has(:root>.type:val("tabs"))');return t.length?t[0]:{tabs:[]}},C=function(e,t,n){var r=new s.Deferred,o=new s.Deferred,i=o.resolve.bind(o);return e(i,n),o.then(function(e){if(e){var r=e.label,o=e.render,i=e.onDestroy,a=void 0===i?u.noop:i,s=x(t),c="tab"+s.tabs.length,f="header_"+c,l="content_"+c;s.tabs.push({label:c,header:[{type:"label",name:f,text:r}],items:[{name:l,type:"container"}]});var d=(0,m.addBusListener)(l,"afterRender",function(e){"string"==typeof o?e.data.element.html(o):o(e.data.element.first(),n)}),p=(0,m.addBusListener)(l,"destroy",function(e){d.remove(),p.remove(),a(e)})}}).then(function(){var e=a({},t,{context:n});r.resolve(e)}),r.promise()},w=function(e){var t=100500;y.on("configReadyForIntegration",function(t){var n={children:t.data.children},r=t.data.context,o=C(e,n,r);t.data.integrationReadyPromise=(0,s.when)(t.data.integrationReadyPromise,o).then(function(e){return e})},null,null,t)},L=function(e){return e.toLowerCase()},j=function(e,t){return(0,u.find)(t,function(t){return L(t.name)===L(e)})},O=function(e,t,n){return e.getDef(t.entityType.name,{id:t.id,fields:["customFields"]}).then(function(e){return j(n,e.customFields)})},N=function(e,t,n,r){var o={};return e.on({eventName:"afterSave",type:t.entityType.name,listener:o,filter:{id:t.id},hasChanges:["customFields"]},function(e){var t=j(n,e.data.changes.customFields);t&&r(t.value)}),o},B=function(e,t){switch(L(e.type)){case"url":return t&&t.url?t.url:null;case"templatedurl":return t?String(t).replace(/\{0\}/,t):null;default:return""}},R=function(e,t){return(0,u.isFunction)(e)?e(t):c["default"].tmpl(e,t)},S=function(e){var t=80,n=e.closest(".tau-page-entity").find(".additional-info");e.css({height:n.height()-t})},U=function(e,t,n,r,o){var i=B(n,r),a={url:i,name:n.name},u=(0,c["default"])(R(i?t:b,a));if((0,c["default"])(e).html(u),o){var s=3e3;S(u),setTimeout(function(){return S(u)},s)}},A=function(e,t,n,r,o){var i=!n.frameTemplate,a=n.frameTemplate||g;(0,s.when)(O(e,t,n.customFieldName)).then(function(e){var t=e.value;return U(o,a,r,t,i)});var u=N(e,t,n.customFieldName,function(e){return U(o,a,r,e,i)});return function(){return e.unbind(u)}},z=function(e){return p["default"].create(e,l["default"])},E=function(e,t){return(0,s.when)(z(e)).then(function(e){return(0,u.find)(e.getCustomFields(),function(e){return L(e.name)===L(t.customFieldName)&&L(e.entityKind)===L(t.entityTypeName)})})},F=function(e){return(0,s.when)(z(e)).then(function(e){return e.getProcess()})},T=function(e){return"url"===L(e.type)||"templatedurl"===L(e.type)},D=function(e){return w(function(t,n){var r=n.entity,o=n.configurator.getStore();return L(r.entityType.name)!==L(e.entityTypeName)?t():(0,s.when)(E(r,e),e.processName?F(r):null).then(function(n,a){if(!n||!T(n))return t();if(a&&L(a.name)!==L(e.processName))return t();try{var u=function(){var i=void 0;return{v:t({label:e.customFieldName,render:function(t){i=A(o,r,e,n,t)},onDestroy:function(){return i()}})}}();if("object"===("undefined"==typeof u?"undefined":i(u)))return u.v}catch(s){throw t(),s}})})},k=function(e){return e.tabs.forEach(D)};k(e.config)},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e,t){e.exports=o},function(e,t,n){"use strict";var r=n(7),o=n(8),i=n(9),a=n(13);e.exports={addBusListener:o.addBusListener,addBusListenerOnce:o.addBusListenerOnce,getAppConfigurator:r.getAppConfigurator,configurator:r,events:o,customUnits:i,debug:a}},function(e,t,n){"use strict";var r=n(4),o=n(3),i=new o.Deferred;r.getGlobalBus().on("configurator.ready",function(e,t){t._id&&!t._id.match(/global/)&&i.resolve(t)});var a=function(){return i.promise()};e.exports={getAppConfigurator:a}},function(e,t,n){"use strict";var r=n(4),o=r.getBusRegistry(),i=function(e){return function(){e.apply(null,Array.prototype.slice.call(arguments).slice(1))}},a=function(e,t,n,r){var a=i(function(o){var i=o.bus;i.name===e&&i[r?"once":"on"](t,n)}),u=o.addEventListener("create",a);return o.addEventListener("destroy",i(function(r){var o=r.bus;o.name===e&&o.removeListener(t,n,u)})),{remove:function(){o.removeListener("create",a,u),o.getByName(e).then(function(e){e.removeListener(t,n,u)})}}},u=function(e,t,n){return a(e,t,n,!0)};e.exports={addBusListener:a,addBusListenerOnce:u}},function(e,t,n){"use strict";var r=n(10),o=n(11),i=n(12).openUnitEditor,a=n(7),u=function(e){return Object.keys(e||{}).reduce(function(t,n){return t[n]=e[n],t},{})},s=function(e){var t=u(e);return t.types=t.types||[r.ANY_TYPE],t.sizes=t.sizes||Object.keys(o).map(function(e){return o[e]}),a.getAppConfigurator().then(function(n){var r=n.getUnitsRegistry();if(!t.id)throw new Error('Field "id" is required for custom unit config');if(r.units[t.id])throw new Error('Custom unit with id "'+t.id+'" has been already registered');t.name=t.name||t.id,t.model=t.model||t.sampleData?t.model:{dummy:1},"string"!=typeof t.model&&"object"==typeof t.model&&(t.model=Object.keys(t.model).reduce(function(e,n){return e.concat(n+":"+t.model[n])},[]).join(", ")),t.sampleData=t.sampleData||{},t.template="object"==typeof e.template?u(t.template):t.template||{markup:['<div class="tau-board-unit__value">'+t.id+"</div>"]},"string"==typeof t.template&&(t.template={markup:[t.template]}),"string"==typeof t.template.markup&&(t.template.markup=[t.template.markup]),t.outerClassName&&(t.classId=t.outerClassName),t.priority&&(t.priority=Number(t.priority)),t.isEditable&&(t.interactionConfig={isEditable:t.isEditable},t.editorHandler?t.interactionConfig.handler=t.editorHandler:t.interactionConfig.handler=function(e,n){var r=e.cardDataForUnit,o=t.editorComponentName instanceof Function?t.editorComponentName(r):t.editorComponentName,a=i(o,{});if(t.editorData){var u={};Object.keys(t.editorData).forEach(function(e){var n=t.editorData[e];u[e]=n instanceof Function?n(r):r[n]}),e.cardDataForUnit=u}return a(e,n)}),r.units[t.id]=r.register([t])[t.id]})};e.exports={types:r,sizes:o,add:s}},function(e,t){e.exports=i},function(e,t){e.exports=a},function(e,t){e.exports=u},function(e,t,n){"use strict";var r=n(4),o=r.getBusRegistry(),i=function(){o.on("create",function(e,t){var n=t.bus;n.on("afterRender",function(e,t){t.element.attr("data-component-name",n.name)})})},a=function(e,t){var n=e;e?"string"==typeof e&&(n=function(t){return(t.name||t.id)===e}):n=function(){return!0},t||(t=function(e,t,n){console.log("LOG BUS",e,t,n)});var o=r.getGlobalBus(),i=o.fire.bind(o);o.fire=function(e,r,o){return o&&n(o,e,r)&&t(o.name||o.id,e,r),i(e,r,o)}};e.exports={showComponentsNames:i,logBus:a}},function(e,t,n){var r=n(15);"string"==typeof r&&(r=[[e.id,r,""]]);n(17)(r,{});r.locals&&(e.exports=r.locals)},function(e,t,n){t=e.exports=n(16)(),t.push([e.id,".XQLfJ1fOSeM_6mWJdOjSz{width:100%;height:700px;overflow:scroll;border:1px solid #ccc;min-height:70vh}._2hqpnQvyimzihTcycgAvjw{color:#bbb;font-size:11px;display:block}",""]),t.locals={frame:"XQLfJ1fOSeM_6mWJdOjSz",empty:"_2hqpnQvyimzihTcycgAvjw"}},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(r[i]=!0)}for(o=0;o<t.length;o++){var a=t[o];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},function(e,t,n){function r(e,t){for(var n=0;n<e.length;n++){var r=e[n],o=p[r.id];if(o){o.refs++;for(var i=0;i<o.parts.length;i++)o.parts[i](r.parts[i]);for(;i<r.parts.length;i++)o.parts.push(c(r.parts[i],t))}else{for(var a=[],i=0;i<r.parts.length;i++)a.push(c(r.parts[i],t));p[r.id]={id:r.id,refs:1,parts:a}}}}function o(e){for(var t=[],n={},r=0;r<e.length;r++){var o=e[r],i=o[0],a=o[1],u=o[2],s=o[3],c={css:a,media:u,sourceMap:s};n[i]?n[i].parts.push(c):t.push(n[i]={id:i,parts:[c]})}return t}function i(e,t){var n=v(),r=b[b.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),b.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(t)}}function a(e){e.parentNode.removeChild(e);var t=b.indexOf(e);t>=0&&b.splice(t,1)}function u(e){var t=document.createElement("style");return t.type="text/css",i(e,t),t}function s(e){var t=document.createElement("link");return t.rel="stylesheet",i(e,t),t}function c(e,t){var n,r,o;if(t.singleton){var i=g++;n=y||(y=u(t)),r=f.bind(null,n,i,!1),o=f.bind(null,n,i,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=s(t),r=d.bind(null,n),o=function(){a(n),n.href&&URL.revokeObjectURL(n.href)}):(n=u(t),r=l.bind(null,n),o=function(){a(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else o()}}function f(e,t,n,r){var o=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=x(t,o);else{var i=document.createTextNode(o),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(i,a[t]):e.appendChild(i)}}function l(e,t){var n=t.css,r=t.media;t.sourceMap;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function d(e,t){var n=t.css,r=(t.media,t.sourceMap);r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var o=new Blob([n],{type:"text/css"}),i=e.href;e.href=URL.createObjectURL(o),i&&URL.revokeObjectURL(i)}var p={},m=function(e){var t;return function(){return"undefined"==typeof t&&(t=e.apply(this,arguments)),t}},h=m(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),v=m(function(){return document.head||document.getElementsByTagName("head")[0]}),y=null,g=0,b=[];e.exports=function(e,t){t=t||{},"undefined"==typeof t.singleton&&(t.singleton=h()),"undefined"==typeof t.insertAt&&(t.insertAt="bottom");var n=o(e);return r(n,t),function(e){for(var i=[],a=0;a<n.length;a++){var u=n[a],s=p[u.id];s.refs--,i.push(s)}if(e){var c=o(e);r(c,t)}for(var a=0;a<i.length;a++){var s=i[a];if(0===s.refs){for(var f=0;f<s.parts.length;f++)s.parts[f]();delete p[s.id]}}}};var x=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()},function(e,t,n){e.exports=n.p+"./mashup.config.js"},function(e,t){}])})}();